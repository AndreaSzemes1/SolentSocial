(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[903],{4685:(e,t,n)=>{Promise.resolve().then(n.bind(n,6414))},6414:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>x});var r=n(5155),l=n(3170);n(8413);var a=n(1956),s=n.n(a),i=n(2115),o=n(5725);s()(()=>n.e(761).then(n.t.bind(n,8741,23)),{loadableGenerated:{webpack:()=>[8741]},ssr:!1});let d=e=>{let{event:t,onClose:l}=e,a=(0,i.useRef)(null),s=(0,i.useRef)(null),[d,u]=(0,i.useState)(null);return(0,i.useEffect)(()=>{if(t&&t.location&&a.current)return n.e(761).then(n.t.bind(n,8741,23)).then(e=>{if(u(e),s.current){s.current.setView([t.location.latitude,t.location.longitude],13);return}s.current=e.map(a.current,{center:[t.location.latitude,t.location.longitude],zoom:13}),e.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"\xa9 OpenStreetMap contributors"}).addTo(s.current),e.marker([t.location.latitude,t.location.longitude]).addTo(s.current)}),()=>{s.current&&(s.current.remove(),s.current=null)}},[t]),(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:(0,r.jsxs)("div",{className:"bg-white p-6 rounded shadow-lg w-96 relative",children:[(0,r.jsx)(o.A,{event:t}),(0,r.jsx)("div",{ref:a,className:"h-48 w-full mt-4 rounded-md border border-gray-300"}),(0,r.jsx)("button",{className:"mt-4 bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-700 transition w-full",onClick:l,children:"Close"})]})})};var u=n(9695),c=n(7406),f=n(399),m=n(7058),h=n(6046);let x=()=>{let[e,t]=(0,i.useState)(null),[n,a]=(0,i.useState)(!0),[s,o]=(0,i.useState)([]),[x,p]=(0,i.useState)([]),[y,g]=(0,i.useState)(null),[b,v]=(0,i.useState)({isOpen:!1,eventId:null}),j=(0,h.useRouter)(),w=(0,f.xI)(c.y),k=(0,m.aU)(c.y);(0,i.useEffect)(()=>{let e=(0,f.hg)(w,async e=>{e?t(e):(a(!1),j.push("/login"))});return()=>e()},[w,j]),(0,i.useEffect)(()=>{e&&(async()=>{try{let t=(0,m.H9)(k,"users",e.uid),n=await (0,m.x7)(t);if(n.exists()&&n.data().bookings){let e=n.data().bookings.map(async e=>{let t=(0,m.H9)(k,"events",e),n=await (0,m.x7)(t);return n.exists()?{id:n.id,...n.data()}:null}),t=(await Promise.all(e)).filter(Boolean),r=Date.now();o(t.filter(e=>e.date>r)),p(t.filter(e=>e.date<=r))}}catch(e){console.error("Error fetching bookings:",e)}finally{a(!1)}})()},[e,k]);let N=async()=>{if(e&&b.eventId)try{let t=(0,m.H9)(k,"users",e.uid),n=await (0,m.x7)(t),r=(0,m.H9)(k,"events",b.eventId),l=await (0,m.x7)(r);if(n.exists()&&l.exists()){let e=n.data().bookings.filter(e=>e!==b.eventId),a=l.data();await (0,m.mZ)(t,{bookings:e}),await (0,m.mZ)(r,{capacity:a.capacity+1}),o(e=>e.filter(e=>e.id!==b.eventId)),p(e=>e.filter(e=>e.id!==b.eventId))}v({isOpen:!1,eventId:null})}catch(e){console.error("Error canceling booking:",e)}};return(0,r.jsxs)("div",{className:"container mx-auto p-6",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-center mb-6",children:"Booking History"}),n?(0,r.jsx)("p",{className:"text-center text-gray-600",children:"Loading..."}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Upcoming Events"}),(0,r.jsx)(u.A,{events:s,onDetails:e=>g(e),onCancel:e=>v({isOpen:!0,eventId:e}),buttonTypes:{details:!0,cancel:!0}}),(0,r.jsx)("h2",{className:"text-xl font-semibold mt-8 mb-4",children:"Past Events"}),(0,r.jsx)(u.A,{events:x,onDetails:e=>g(e),buttonTypes:{details:!0,cancel:!1}})]}),y&&(0,r.jsx)(d,{event:y,onClose:()=>g(null)}),(0,r.jsx)(l.A,{isOpen:b.isOpen,message:"Are you sure you want to cancel this booking?",onConfirm:N,onCancel:()=>v({isOpen:!1,eventId:null})})]})}},5725:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(5155),l=n(4057);let a=(0,l.A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),s=(0,l.A)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),i=e=>{let{event:t,onTitleClick:n}=e;return(0,r.jsxs)("div",{className:"bg-white shadow-md rounded-lg p-4 border border-gray-300 hover:shadow-lg transition cursor-pointer",children:[(0,r.jsx)("h3",{className:"text-lg font-bold text-gray-800 hover:underline",onClick:n,children:t.title}),(0,r.jsx)("p",{className:"text-sm text-gray-500 font-semibold",children:t.type}),(0,r.jsxs)("div",{className:"flex items-center text-gray-600 text-sm mt-2",children:[(0,r.jsx)(a,{size:16,className:"mr-2 text-blue-500"}),(0,r.jsx)("span",{children:new Date(t.date).toLocaleDateString()})]}),(0,r.jsxs)("div",{className:"flex items-center text-gray-600 text-sm mt-1",children:[(0,r.jsx)(s,{size:16,className:"mr-2 text-red-500"}),(0,r.jsx)("span",{children:t.locationName||"Unknown"})]})]})}},1956:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return l}});let r=n(306)._(n(580));function l(e,t){var n;let l={};"function"==typeof e&&(l.loader=e);let a={...l,...t};return(0,r.default)({...a,modules:null==(n=a.loadableGenerated)?void 0:n.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},9827:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return l}});let r=n(3719);function l(e){let{reason:t,children:n}=e;if("undefined"==typeof window)throw new r.BailoutToCSRError(t);return n}},580:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return d}});let r=n(5155),l=n(2115),a=n(9827),s=n(9214);function i(e){return{default:e&&"default"in e?e.default:e}}let o={loader:()=>Promise.resolve(i(()=>null)),loading:null,ssr:!0},d=function(e){let t={...o,...e},n=(0,l.lazy)(()=>t.loader().then(i)),d=t.loading;function u(e){let i=d?(0,r.jsx)(d,{isLoading:!0,pastDelay:!0,error:null}):null,o=!t.ssr||!!t.loading,u=o?l.Suspense:l.Fragment,c=t.ssr?(0,r.jsxs)(r.Fragment,{children:["undefined"==typeof window?(0,r.jsx)(s.PreloadChunks,{moduleIds:t.modules}):null,(0,r.jsx)(n,{...e})]}):(0,r.jsx)(a.BailoutToCSR,{reason:"next/dynamic",children:(0,r.jsx)(n,{...e})});return(0,r.jsx)(u,{...o?{fallback:i}:{},children:c})}return u.displayName="LoadableComponent",u}},9214:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadChunks",{enumerable:!0,get:function(){return i}});let r=n(5155),l=n(7650),a=n(5861),s=n(8284);function i(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let n=a.workAsyncStorage.getStore();if(void 0===n)return null;let i=[];if(n.reactLoadableManifest&&t){let e=n.reactLoadableManifest;for(let n of t){if(!e[n])continue;let t=e[n].files;i.push(...t)}}return 0===i.length?null:(0,r.jsx)(r.Fragment,{children:i.map(e=>{let t=n.assetPrefix+"/_next/"+(0,s.encodeURIPath)(e);return e.endsWith(".css")?(0,r.jsx)("link",{precedence:"dynamic",href:t,rel:"stylesheet",as:"style"},e):((0,l.preload)(t,{as:"script",fetchPriority:"low"}),null)})})}},4057:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(2115);let l=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),a=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((e,t,n)=>!!e&&""!==e.trim()&&n.indexOf(e)===t).join(" ").trim()};var s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,r.forwardRef)((e,t)=>{let{color:n="currentColor",size:l=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:d="",children:u,iconNode:c,...f}=e;return(0,r.createElement)("svg",{ref:t,...s,width:l,height:l,stroke:n,strokeWidth:o?24*Number(i)/Number(l):i,className:a("lucide",d),...f},[...c.map(e=>{let[t,n]=e;return(0,r.createElement)(t,n)}),...Array.isArray(u)?u:[u]])}),o=(e,t)=>{let n=(0,r.forwardRef)((n,s)=>{let{className:o,...d}=n;return(0,r.createElement)(i,{ref:s,iconNode:t,className:a("lucide-".concat(l(e)),o),...d})});return n.displayName="".concat(e),n}}},e=>{var t=t=>e(e.s=t);e.O(0,[484,523,992,361,807,28,441,517,358],()=>t(4685)),_N_E=e.O()}]);